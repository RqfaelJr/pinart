{% extends "base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/form.css' %}">

<div class="form-container">

    <h1 class="page-title">Criar Evento</h1>

    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}

        <div class="form-card">
        <label class="form-label">Imagem do Evento</label>
        
        <div class="image-upload-area position-relative">
            
            {{ form.imagem }}
            
            <div class="upload-content">
                <i class="fa-solid fa-cloud-arrow-up" style="font-size: 2rem; color: #6f42c1;"></i>
                <p>Clique ou arraste para adicionar uma imagem<br><span>PNG, JPG ou GIF (max. 10MB)</span></p>
            </div>
            
        </div>
    </div>

        <div class="form-card">
            <label class="form-label">Título do Evento</label>
            {{ form.titulo }}
        </div>

        <div class="form-card">
            <label class="form-label">Descrição</label>
            {{ form.descricao }}
        </div>

       <div class="two-columns">
            <div class="form-card">
                <label class="form-label">Início</label>
                {{ form.data_hora_inicio }}
            </div>
            <div class="form-card">
                <label class="form-label">Fim</label>
                {{ form.data_hora_fim }}
            </div>
        </div>

        <div class="form-card">
            <label class="form-label">Local</label>
            <div class="input-group">
                {{ form.local }}
                <button type="button" class="btn-add" onclick="abrirModalLocal()" title="Adicionar novo local">
                    +
                </button>
            </div>
        </div>
        
        <div class="form-card">
            <label class="form-label">Capacidade</label>
            {{ form.capacidade }}
        </div>

        <div class="form-card">
            <div class="label-with-action">
                <label class="form-label">Categorias</label>
                <a href="{% url 'create_categoria' %}" class="btn-add-small" title="Nova categoria" target="_blank">
                    + Nova
                </a>
            </div>
            
            <div class="category-container">
                {% for cat in form.categorias %}
                    <label class="category-chip">
                        {{ cat.tag }} <span>{{ cat.choice_label }}</span> </label>
                {% endfor %}
            </div>
        </div>

        <div class="actions">
            <button type="submit" class="btn-primary">Salvar</button>
            <a href="{% url 'home' %}" class="btn-secondary">Cancelar</a>
        </div>

        {% if form.errors %}
            <div class="alert alert-danger">
                {{ form.errors }}
            </div>
        {% endif %}

    </form>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const uploadArea = document.querySelector('.image-upload-area');
        const fileInput = uploadArea.querySelector('input[type="file"]');
        const contentDiv = uploadArea.querySelector('.upload-content');

        const originalContent = contentDiv.innerHTML;

        fileInput.addEventListener('change', function(event) {
            const file = event.target.files[0];

            if (file) {
                const imageSrc = URL.createObjectURL(file);

                contentDiv.innerHTML = `
                    <img src="${imageSrc}" class="preview-img">
                    <div class="success-message">
                        <i class="fa-solid fa-check-circle"></i> Imagem selecionada!
                    </div>
                    <span class="file-name">${file.name}</span>
                `;

                uploadArea.style.borderColor = "#6f42c1";
                uploadArea.style.backgroundColor = "#f3e8ff";
            } else {
                contentDiv.innerHTML = originalContent;
                uploadArea.style.borderColor = "#ccc";
                uploadArea.style.backgroundColor = "#f9f9f9";
            }
        });
    });
</script>
{% include 'includes/modal_local.html' %}
{% endblock %}


